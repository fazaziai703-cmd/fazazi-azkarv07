<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0a2463">
  <meta name="description" content="تطبيق أذكار متكامل مع أوقات الصلاة وتلاوة القرآن">
  <title>Fazazi Azkar</title>
  
  <!-- PWA Manifest and Icons -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
  
  <!-- Fonts and Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Noto+Naskh+Arabic&family=Lateefah&family=Scheherazade+New&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <!-- External Libraries -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

  <!-- Custom Stylesheet -->
  <link rel="stylesheet" href="assets/styles/styles.css">
</head>
<body>
  
  <!-- Side Navigation Menu -->
  <div id="mySidenav" class="sidenav">
    <!-- Close button for the sidenav, with an aria-label for accessibility -->
    <button class="closebtn" onclick="closeNav()" aria-label="إغلاق قائمة الأذكار">&times;</button>
    <h3><i class="fas fa-list"></i> قائمة الأذكار</h3>
    <div id="sidenavAzkarList"></div>
  </div>
  
  <!-- Main content area -->
  <div class="top-fixed-buttons">
    <!-- Button to toggle the side navigation, with aria attributes for accessibility -->
    <button class="sidenav-toggle-btn" onclick="toggleNav()" aria-label="فتح قائمة الأذكار" aria-expanded="false" aria-controls="mySidenav">
      <i class="fas fa-bars"></i>
    </button>
    <!-- Main menu button -->
    <button class="button" style="background:#607d8b;" onclick="resetApp()" aria-label="العودة للقائمة الرئيسية">
      <i class="fas fa-home"></i> العودة للقائمة الرئيسية
    </button>
    <!-- Install app button, hidden by default -->
    <button id="installAppBtn" class="button" style="background:#8bc34a; display:none;" aria-label="تثبيت التطبيق">
      <i class="fas fa-plus"></i> تثبيت التطبيق
    </button>
    <!-- Focus View button -->
    <button id="enterFocusBtn" class="button" style="background:#0a2463;" aria-label="تشغيل وضع التركيز">
      <i class="fas fa-expand"></i> وضع التركيز
    </button>
  </div>
  
  <div class="container main-content-padding" id="mainContent">
    <h1 class="text-center my-4 app-title">أذكار الفزازي | Fazazi Azkar</h1>
    
    <!-- Tab navigation -->
    <ul class="nav nav-tabs justify-content-center" id="mainTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="azkar-tab" data-bs-toggle="tab" data-bs-target="#mainTab" type="button" role="tab" aria-controls="mainTab" aria-selected="true">
          <i class="fas fa-book"></i> الأذكار
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="prayer-tab" data-bs-toggle="tab" data-bs-target="#prayerTab" type="button" role="tab" aria-controls="prayerTab" aria-selected="false">
          <i class="fas fa-mosque"></i> أوقات الصلاة
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="quran-tab" data-bs-toggle="tab" data-bs-target="#quranTab" type="button" role="tab" aria-controls="quranTab" aria-selected="false">
          <i class="fas fa-quran"></i> القرآن
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contactTab" type="button" role="tab" aria-controls="contactTab" aria-selected="false">
          <i class="fas fa-envelope"></i> تواصل
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settingsTab" type="button" role="tab" aria-controls="settingsTab" aria-selected="false">
          <i class="fas fa-cog"></i> الإعدادات
        </button>
      </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content" id="mainTabContent">
      <div class="tab-pane fade show active" id="mainTab" role="tabpanel" aria-labelledby="azkar-tab">
        <!-- Content for Azkar main page will be rendered here by app.js -->
        <!-- This div will be populated by your app.js logic for Azkar categories and content -->
      </div>
      <div class="tab-pane fade" id="prayerTab" role="tabpanel" aria-labelledby="prayer-tab">
        <!-- Prayer Times content will be dynamically loaded here -->
      </div>
      <div class="tab-pane fade" id="quranTab" role="tabpanel" aria-labelledby="quran-tab">
        <!-- Quran content will be dynamically loaded here -->
      </div>
      <div class="tab-pane fade" id="contactTab" role="tabpanel" aria-labelledby="contact-tab">
        <!-- Contact Us content will be dynamically loaded here -->
        <div class="container contact-container mt-4 text-center">
          <h3 class="mb-4">تواصل معنا</h3>
          <p>
            إذا كان لديك أي اقتراحات أو ملاحظات أو إذا واجهت مشكلة، لا تتردد في التواصل معنا.
          </p>
          <a href="mailto:abou.imran@fazazi.com" class="button btn btn-primary mt-3"><i class="fas fa-envelope"></i> إرسال بريد إلكتروني</a>
        </div>
      </div>
      <div class="tab-pane fade" id="settingsTab" role="tabpanel" aria-labelledby="settings-tab">
        <!-- Settings content will be dynamically loaded here -->
        <!-- This section will be populated by app.js -->
      </div>
    </div>
  </div>
  
  <!-- Info/Share Modal -->
  <div id="infoShareModal" class="modal-overlay">
    <div class="modal-content">
      <h3 id="modalTitle">
        <!-- Close button for the modal, with an aria-label for accessibility -->
        <button class="close-button" onclick="closeModal()" aria-label="إغلاق النافذة المنبثقة">
          <i class="fas fa-times-circle"></i>
        </button>
        <span id="modalHeaderText"></span>
      </h3>
      <p id="modalBodyText"></p>
      <div id="modalButtons"></div>
    </div>
  </div>
  
  <!-- The new focus view container. This will overlay all other content. -->
  <div id="focus-view-container">
    <!-- The exit button with the 'x' icon -->
    <button id="exitFocusBtn" aria-label="الخروج من وضع التركيز">
        <i class="fas fa-times"></i>
    </button>
    <!-- This is where the Azkar text will be displayed in focus mode -->
    <div class="focus-content">
        <!-- The content will be populated dynamically by app.js -->
    </div>
  </div>
  
  <!-- Footer section with copyright and dedication -->
  <div class="footer">
    <p>
      تطبيق أذكار، صلاة وقرآن - <span id="currentYear"></span> &copy; جميع الحقوق محفوظة
    </p>
    <p>
      إهداء إلى ابني عمران (عبقرينو)، مع دعواتي له بدوام التفوق والتوفيق. والدكم المحب/ أبو عمران الفزازي
    </p>
  </div>
  
  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="js/app.js"></script>
  <script src="js/prayer-times.js"></script>
  <script src="js/quran-recitation.js"></script>
  <script>
    // Service Worker registration for PWA functionality
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js').then(reg => {
          console.log('Service Worker registered! 😎', reg);
        }).catch(err => {
          console.log('Service Worker registration failed: 😭', err);
        });
      });
    }

    // Set the current year in the footer dynamically
    document.getElementById('currentYear').textContent = new Date().getFullYear();

    // Listen for Bootstrap's 'shown.bs.tab' event to trigger content loading
    document.addEventListener('DOMContentLoaded', () => {
        const mainTabsEl = document.getElementById('mainTabs');
        if (mainTabsEl) {
            mainTabsEl.addEventListener('shown.bs.tab', function (event) {
                const targetTabId = event.target.getAttribute('data-bs-target').substring(1);
                // The `openTab` function from app.js is now triggered by this event
                if (typeof openTab === 'function') {
                    openTab(targetTabId, event.target);
                }
            });
            // Manually trigger the event for the initially active tab on page load
            const initialActiveTabButton = mainTabsEl.querySelector('.nav-link.active');
            if (initialActiveTabButton) {
                new bootstrap.Tab(initialActiveTabButton).show();
            }
        }
    });
  </script>
</body>
</html>
