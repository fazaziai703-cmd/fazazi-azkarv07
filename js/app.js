// بيانات أذكار الصباح
const morningAzkar = [
      { text: "آيَةُ الكُرْسِيِّ:\nاللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ۚ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ ۚ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ ۗ مَن ذَا الَّذِي يَشْفَعُ عِندَهُ إِلَّا بِإِذْنِهِ ۚ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ ۖ وَلَا يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلَّا بِمَا شَاءَ ۚ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ ۖ وَلَا يَئُودُهُ حِفْظُهُمَا ۚ وَهُوَ الْعَلِيُّ الْعَظِيمُ",
        repeat: 1,
        meaning: "الآية الكريمة تبين عظمة الله تعالى، وأنه المتفرد بالألوهية، الحي الذي لا يموت، القائم على تدبير كل شيء، لا يغفل ولا ينام، وهو مالك كل شيء، ولا يشفع أحد عنده إلا بإذنه، وعلمه محيط بكل شيء، ولا يعجزه حفظ السماوات والأرض.",
        virtue: "فضلها: من قرأها حين يصبح أجير من الجن حتى يمسي، ومن قرأها حين يمسي أجير منهم حتى يصبح.",
        source: "رواه النسائي", hadith_number: "لا يوجد رقم حديث محدد في النسخة الأصلية للنسائي، يُعرف بالحديث في فضائل آية الكرسي."
      },
      { text: "سُورَةُ الإِخْلَاصِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ هُوَ اللَّهُ أَحَدٌ (1)\nاللَّهُ الصَّمَدُ (2)\nلَمْ يَلِدْ وَلَمْ يُولَدْ (3)\nوَلَمْ يَكُن لَّهُ كُفُوًا أَحَدٌ (4)",
        repeat: 3,
        meaning: "تعلن السورة توحيد الله المطلق، وأنه واحد لا شريك له، وهو الصمد الذي تقصده المخلوقات في حوائجها، لم يلد ولم يولد، وليس له مثيل ولا نظير.",
        virtue: "فضلها: تعدل ثلث القرآن في الأجر، ومن قرأها ثلاث مرات في الصباح والمساء كفته من كل شيء.",
        source: "رواه الترمذي وصححه الألباني", hadith_number: "2903"
      },
      { text: "سُورَةُ الْفَلَقِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ الْفَلَقِ (1)\nمِن شَرِّ مَا خَلَقَ (2)\nوَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ (3)\nوَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ (4)\nوَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ (5)",
        repeat: 3,
        meaning: "يطلب المسلم من الله تعالى الحماية من كل المخلوقات الشريرة، ومن شر الليل إذا أقبل بظلامه، ومن شر السحر والسحرة، ومن شر الحاسدين.",
        virtue: "فضلها: حرز للمسلم وحصن له من كل شرور الدنيا، وقد أوصى بها النبي صلى الله عليه وسلم.",
        source: "رواه الترمذي وصححه الألباني", hadith_number: "3367"
      },
      { text: "سُورَةُ النَّاسِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ النَّاسِ (1)\nمَلِكِ النَّاسِ (2)\nإِلَٰهِ النَّاسِ (3)\nمِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ (4)\nالَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ (5)\nمِنَ الْجِنَّةِ وَالنَّاسِ (6)",
        repeat: 3,
        meaning: "يتعوذ المسلم بالله رب الناس وملكهم وإلههم من شر وسوسة الشيطان، سواء كان من الجن أو من الإنس، الذي يلقي الشكوك والشر في القلوب.",
        virtue: "فضلها: حرز للمسلم وحصن له من وسوسة الشياطين من الجن والإنس، وهي من المعوذات التي تقي المسلم من الشرور.",
        source: "رواه الترمذي وصححه الألباني", hadith_number: "3367"
      },
      { text: "أذكار الصباح\n\nأَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ. رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذَا الْيَوْمِ وَخَيْرَ مَا بَعْدَهُ، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذَا الْيَوْمِ وَشَرِّ مَا بَعْدَهُ. رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.",
        repeat: 1,
        meaning: "يقر المسلم بأن ملك الكون كله لله تعالى في هذا الصباح، ويثني عليه بالحمد، ويشهد بوحدانيته، ويسأله خير اليوم وما بعده من أيام، ويستعيذ به من شر هذا اليوم وما بعده، ومن الكسل الذي يعيق عن الطاعة، ومن كبر السن الذي يؤدي إلى ضعف العبادة، ومن عذاب النار والقبر.",
        virtue: "يقوله المسلم كل صباح ليفتتح يومه بالخير ويطلب الحماية من الشرور، وهو من أذكار الصباح الأساسية التي تعكس التوكل على الله والاستعانة به في أمور الدنيا والآخرة.",
        source: "رواه مسلم", hadith_number: "2723"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ بِكَ أَصْبَحْنَا، وَبِكَ أَمْسَيْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ النُّشُورُ.",
        repeat: 1,
        meaning: "دعاء يجدد فيه المسلم توكله على الله في كل شؤون حياته ومماته، ويقر بأن البقاء والوجود بيد الله وحده، وإليه المصير والبعث يوم القيامة.",
        virtue: "من الأذكار الجامعة التي تبين كمال التوكل على الله في بداية اليوم، وأن الأمر كله بيده.",
        source: "رواه الترمذي", hadith_number: "3391"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لَا يَغْفِرُ الذُّنُوبَ إِلَّا أَنْتَ.",
        repeat: 1,
        meaning: "يُعرف هذا الذكر بـ 'سيد الاستغفار'، وفيه يقر المسلم بتوحيد الله وربوبيته، وبأنه خلقه وهو عبده، وأنه يسعى جاهدًا للوفاء بعهد الله ووعده ما استطاع، ويستعيذ بالله من شر أعماله، ويعترف بإنعام الله عليه وبذنوبه، ويطلب المغفرة من الله وحده.",
        virtue: "فضلها: سيد الاستغفار، من قاله موقناً به حين يصبح فمات من يومه دخل الجنة، ومن قاله موقناً به حين يمسي فمات من ليلته دخل الجنة.",
        source: "رواه البخاري", hadith_number: "6306"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ إِنِّي أَصْبَحْتُ أُشْهِدُكَ وَأُشْهِدُ حَمَلَةَ عَرْشِكَ وَمَلَائِكَتَكَ وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ لَا إِلَهَ إِلَّا أَنْتَ وَحْدَكَ لَا شَرِيكَ لَكَ، وَأَنَّ مُحَمَّدًا عَبْدُكَ وَرَسُولُكَ.",
        repeat: 4,
        meaning: "يستشهد المسلم الله وملائكته وحملة عرشه وجميع خلقه على توحيد الله وربوبيته وإلهيته، وعلى نبوة محمد صلى الله عليه وسلم، تأكيدًا لإيمانه ويقينه.",
        virtue: "فضلها: من قالها أربع مرات حين يصبح أو يمسي أعتقه الله من النار.",
        source: "رواه أبو داود", hadith_number: "5071"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ مَا أَصْبَحَ بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ فَمِنْكَ وَحْدَكَ لَا شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ.",
        repeat: 1,
        meaning: "يقر المسلم بأن كل نعمة وصلت إليه أو إلى غيره من الخلق هي من الله وحده لا شريك له في ذلك، ويحمده ويشكره عليها.",
        virtue: "فضلها: من قالها حين يصبح فقد أدى شكر يومه، ومن قالها حين يمسي فقد أدى شكر ليلته.",
        source: "رواه أبو داود", hadith_number: "5073"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ عَافِنِي فِي بَدَنِي، اللَّهُمَّ عَافِنِي فِي سَمْعِي، اللَّهُمَّ عَافِنِي فِي بَصَرِي، لَا إِلَهَ إِلَّا أَنْتَ.",
        repeat: 3,
        meaning: "دعاء جامع يطلب فيه المسلم من الله تعالى أن يعافيه في صحته الجسدية، وفي حواس السمع والبصر، مؤكدًا على توحيد الله.",
        virtue: "من الأذكار التي تطلب من الله العافية في الجسد والحواس، وهي من جوامع الدعاء.",
        source: "رواه أبو داود", hadith_number: "5090"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْكُفْرِ وَالْفَقْرِ، اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عَذَابِ الْقَبْرِ، لَا إِلَهَ إِلَّا أَنْتَ.",
        repeat: 3,
        meaning: "يستعيذ المسلم بالله من الكفر الذي هو أشد الضلال، ومن الفقر الذي قد يجر إلى الكفر، ومن عذاب القبر.",
        virtue: "دعاء جامع لطلب الحماية من أعظم الشرور في الدنيا والآخرة.",
        source: "رواه أبو داود", hadith_number: "5090"
      },
      { text: "أذكار الصباح\n\nحَسْبِيَ اللَّهُ لَا إِلَهَ إِلَّا هُوَ عَلَيْهِ تَوَكَّلْتُ وَهُوَ رَبُّ الْعَرْشِ الْعَظِيمِ.",
        repeat: 7,
        meaning: "يؤكد المسلم أن الله وحده يكفيه ويحميه، لا معبود بحق سواه، وعليه وحده توكل في جميع أموره، وهو رب العرش العظيم، أي مالك كل شيء.",
        virtue: "فضلها: من قالها سبع مرات حين يصبح أو يمسي كفاه الله ما أهمه من أمر الدنيا والآخرة.",
        source: "رواه أبو داود", hadith_number: "5081"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي الدُّنْيَا وَالْآخِرَةِ، اللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي دِينِي وَدُنْيَايَ وَأَهْلِي وَمَالِي، اللَّهُمَّ اسْتُرْ عَوْرَاتِي، وَآمِنْ رَوْعَاتِي، اللَّهُمَّ احْفَظْنِي مِنْ بَيْنِ يَدَيَّ وَمِنْ خَلْفِي وَعَنْ يَمِينِي وَعَنْ شِمَالِي وَمِنْ فَوْقِي، وَأَعُوذُ بِعَظَمَتِكَ أَنْ أُغْتَالَ مِنْ تَحْتِي.",
        repeat: 1,
        meaning: "دعاء شامل لطلب العفو والعافية في كل جوانب الحياة الدينية والدنيوية، وللأهل والمال، وستر العيوب، وتأمين المخاوف، وطلب الحفظ من كل الجهات، والاستعاذة من الموت غدرًا.",
        virtue: "من أجمع الأدعية لطلب خير الدنيا والآخرة والحماية من كل الشرور.",
        source: "رواه أبو داود", hadith_number: "5074"
      },
      { text: "أذكار الصباح\n\nيَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ، أَصْلِحْ لِي شَأْنِي كُلَّهُ، وَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ.",
        repeat: 1,
        meaning: "دعاء يتوجه فيه المسلم إلى الله بأسمائه الحسنى 'الحي' الذي لا يموت، 'القيوم' القائم على تدبير كل شيء، مستغيثًا برحمته ليُصلح له كل أموره، وطلبًا لعدم تركه لنفسه أبدًا.",
        virtue: "من الأدعية العظيمة التي تطلب من الله التوفيق في كل الأمور، وعدم التخلي عن العبد لحظة.",
        source: "رواه الحاكم وصححه الذهبي", hadith_number: "1/545"
      },
      { text: "أذكار الصباح\n\nأَصْبَحْنَا عَلَى فِطْرَةِ الْإِسْلَامِ وَكَلِمَةِ الْإِخْلَاصِ وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ وَعَلَى مِلَّةِ أَبِينَا إِبْرَاهِيمَ حَنِيفًا مُسْلِمًا وَمَا كَانَ مِنَ الْمُشْرِكِينَ.",
        repeat: 1,
        meaning: "يجدد المسلم في هذا الذكر عهد إسلامه، وإخلاص توحيده لله، وتمسكه بدين النبي محمد صلى الله عليه وسلم، وملة أبيه إبراهيم عليه السلام التي هي الحنيفية السمحة، براءً من الشرك وأهله.",
        virtue: "تأكيد على الثبات على الإسلام والتوحيد والسنة، واعتزاز بالدين.",
        source: "رواه أحمد", hadith_number: "15360"
      },
      { text: "أذكار الصباح\n\nسُبْحَانَ اللَّهِ وَبِحَمْدِهِ عَدَدَ خَلْقِهِ وَرِضَا نَفْسِهِ وَزِنَةَ عَرْشِهِ وَمِدَادَ كَلِمَاتِهِ.",
        repeat: 3,
        meaning: "تسبيح لله تعالى بصفات الكمال والجمال، وتقديسه بحمد لا يحصيه أحد إلا هو، بقدر عدد مخلوقاته، وبقدر ما يرضي ذاته العلية، وبوزن عرشه العظيم، وبقدر كلمات علمه وحكمته التي لا تنتهي.",
        virtue: "كلمات يسيرة لكنها تحمل أجرًا عظيمًا ومضاعفًا لعظم القدر الذي يذكره المسلم بها، وهي تعدل أضعافًا مضاعفة من الذكر العادي.",
        source: "رواه مسلم", hadith_number: "2726"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ صَلِّ وَسَلِّمْ عَلَى نَبِيِّنَا مُحَمَّدٍ.",
        repeat: 10,
        meaning: "طلب من الله تعالى أن يثني على نبيه محمد صلى الله عليه وسلم في الملأ الأعلى، وأن يحفظه من كل سوء، وأن ينزل عليه الرحمة والبركة والسلام.",
        virtue: "فضل الصلاة على النبي صلى الله عليه وسلم عظيم، فمن صلى عليه صلاة واحدة صلى الله عليه بها عشراً.",
        source: "رواه مسلم", hadith_number: "384"
      },
      { text: "أذكار الصباح\n\nاللَّهُمَّ إِنَّا نَعُوذُ بِكَ مِنْ أَنْ نُشْرِكَ بِكَ شَيْئًا نَعْلَمُهُ، وَنَسْتَغْفِرُكَ لِمَا لَا نَعْلَمُهُ.",
        repeat: 1,
        meaning: "دعاء يطلب فيه المسلم من الله أن يحميه من الوقوع في الشرك، سواء كان الشرك الأكبر أو الأصغر، سواء كان يعلمه أو يقع فيه بغير قصد أو علم، ويسأل الله المغفرة لما قد يكون وقع فيه من شرك خفي لا يعلمه.",
        virtue: "حماية من الشرك الخفي والشرك الجلي، وتجديد للتوبة والرجوع إلى الله.",
        source: "رواه أحمد", hadith_number: "4/403"
      },
      { text: "أذكار الصباح\n\nسُبْحَانَ اللَّهِ وَبِحَمْدِهِ.",
        repeat: 100,
        meaning: "تنـزيه لله عن كل نقص، واعتراف بفضله وكماله، مقروناً بالثناء عليه.",
        virtue: "فضلها: من قالها مائة مرة في اليوم غفرت خطاياه وإن كانت مثل زبد البحر.",
        source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6405، مسلم: 2691"
      },
      { text: "أذكار الصباح\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ.",
        repeat: 100,
        meaning: "إقرار بالتوحيد الخالص لله، وأنه لا معبود بحق سواه، وهو المتفرد بالملك والتصرف في الكون، وله الثناء والحمد، وهو ذو القدرة المطلقة على كل شيء.",
        virtue: "فضلها: من قالها مائة مرة في يوم كانت له عدل عشر رقاب (تحرير عشر عبيد)، وكتبت له مائة حسنة، ومحيت عنه مائة سيئة، وكانت له حرزاً من الشيطان يومه ذلك حتى يمسي، ولم يأت أحد بأفضل مما جاء به إلا رجل عمل أكثر منه.",
        source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6403، مسلم: 2691"
      },
      // أذكار إضافية (أمثلة)
      { text: "أذكار الصباح\n\nرَضِيتُ بِاللَّهِ رَبًّا، وَبِالْإِسْلَامِ دِينًا، وَبِمُحَمَّدٍ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ نَبِيًّا.",
        repeat: 3,
        meaning: "أرضى وأطمئن بالله ربًّا لي ومدبرًا لجميع أموري، وبالإسلام دينًا كاملاً وشاملاً لطريقتي في الحياة، وبمحمد صلى الله عليه وسلم نبيًّا ورسولاً أقتدي به.",
        virtue: "فضلها: من قالها حين يصبح وحين يمسي كان حقًا على الله أن يرضيه يوم القيامة.",
        source: "رواه الترمذي", hadith_number: "3389"
      }
    ];

    const eveningAzkar = [
        { text: "آيَةُ الكُرْسِيِّ:\nاللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ۚ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ ۚ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ ۗ مَن ذَا الَّذِي يَشْفَعُ عِندَهُ إِلَّا بِإِذْنِهِ ۚ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ ۖ وَلَا يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلَّا بِمَا شَاءَ ۚ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ ۖ وَلَا يَئُودُهُ حِفْظُهُمَا ۚ وَهُوَ الْعَلِيُّ الْعَظِيمُ",
          repeat: 1,
          meaning: "الآية الكريمة تبين عظمة الله تعالى، وأنه المتفرد بالألوهية، الحي الذي لا يموت، القائم على تدبير كل شيء، لا يغفل ولا ينام، وهو مالك كل شيء، ولا يشفع أحد عنده إلا بإذنه، وعلمه محيط بكل شيء، ولا يعجزه حفظ السماوات والأرض.",
          virtue: "فضلها: من قرأها حين يمسي أجير من الجن حتى يصبح، ومن قرأها حين يصبح أجير منهم حتى يمسي.",
          source: "رواه النسائي", hadith_number: "لا يوجد رقم حديث محدد في النسخة الأصلية للنسائي، يُعرف بالحديث في فضائل آية الكرسي."
        },
        { text: "سُورَةُ الإِخْلَاصِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ هُوَ اللَّهُ أَحَدٌ (1)\nاللَّهُ الصَّمَدُ (2)\nلَمْ يَلِدْ وَلَمْ يُولَدْ (3)\nوَلَمْ يَكُن لَّهُ كُفُوًا أَحَدٌ (4)",
          repeat: 3,
          meaning: "تعلن السورة توحيد الله المطلق، وأنه واحد لا شريك له، وهو الصمد الذي تقصده المخلوقات في حوائجها، لم يلد ولم يولد، وليس له مثيل ولا نظير.",
          virtue: "فضلها: تعدل ثلث القرآن في الأجر، ومن قرأها ثلاث مرات في الصباح والمساء كفته من كل شيء.",
          source: "رواه الترمذي وصححه الألباني", hadith_number: "2903"
        },
        { text: "سُورَةُ الْفَلَقِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ الْفَلَقِ (1)\nمِن شَرِّ مَا خَلَقَ (2)\nوَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ (3)\nوَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ (4)\nوَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ (5)",
          repeat: 3,
          meaning: "يطلب المسلم من الله تعالى الحماية من كل المخلوقات الشريرة، ومن شر الليل إذا أقبل بظلامه، ومن شر السحر والسحرة، ومن شر الحاسدين.",
          virtue: "فضلها: حرز للمسلم وحصن له من كل شرور الدنيا، وقد أوصى بها النبي صلى الله عليه وسلم.",
          source: "رواه الترمذي وصححه الألباني", hadith_number: "3367"
        },
        { text: "سُورَةُ النَّاسِ:\nبِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ النَّاسِ (1)\nمَلِكِ النَّاسِ (2)\nإِلَٰهِ النَّاسِ (3)\nمِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ (4)\nالَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ (5)\nمِنَ الْجِنَّةِ وَالنَّاسِ (6)",
          repeat: 3,
          meaning: "يتعوذ المسلم بالله رب الناس وملكهم وإلههم من شر وسوسة الشيطان، سواء كان من الجن أو من الإنس، الذي يلقي الشكوك والشر في القلوب.",
          virtue: "فضلها: حرز للمسلم وحصن له من وسوسة الشياطين من الجن والإنس، وهي من المعوذات التي تقي المسلم من الشرور.",
          source: "رواه الترمذي وصححه الألباني", hadith_number: "3367"
        },
        { text: "أذكار المساء\n\nأَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ. رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذِهِ اللَّيْلَةِ وَخَيْرَ مَا بَعْدَهَا، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذِهِ اللَّيْلَةِ وَشَرِّ مَا بَعْدَهَا. رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.",
          repeat: 1,
          meaning: "دعاء المسلم عند المساء يقر فيه بأن ملك الكون كله لله تعالى، ويثني عليه بالحمد، ويشهد بوحدانيته، ويسأله خير هذه الليلة وما بعدها، ويستعيذ به من شر هذه الليلة وما بعدها، ومن الكسل الذي يعيق عن الطاعة، ومن كبر السن الذي يؤدي إلى ضعف العبادة، ومن عذاب النار والقبر.",
          virtue: "يقوله المسلم كل مساء ليختتم يومه بالخير ويطلب الحماية من الشرور، وهو من أذكار المساء الأساسية التي تعكس التوكل على الله والاستعانة به في أمور الدنيا والآخرة.",
          source: "رواه مسلم", hadith_number: "2723"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ بِكَ أَمْسَيْنَا، وَبِكَ أَصْبَحْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ الْمَصِيرُ.",
          repeat: 1,
          meaning: "دعاء يجدد فيه المسلم توكله على الله في كل شؤون حياته ومماته، ويقر بأن البقاء والوجود بيد الله وحده، وإليه المصير والبعث يوم القيامة.",
          virtue: "من الأذكار الجامعة التي تبين كمال التوكل على الله في بداية الليل، وأن الأمر كله بيده.",
          source: "رواه الترمذي", hadith_number: "3391"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لَا يَغْفِرُ الذُّنُوبَ إِلَّا أَنْتَ.",
          repeat: 1,
          meaning: "يُعرف هذا الذكر بـ 'سيد الاستغفار'، وفيه يقر المسلم بتوحيد الله وربوبيته، وبأنه خلقه وهو عبده، وأنه يسعى جاهدًا للوفاء بعهد الله ووعده ما استطاع، ويستعيذ بالله من شر أعماله، ويعترف بإنعام الله عليه وبذنوبه، ويطلب المغفرة من الله وحده.",
          virtue: "فضلها: سيد الاستغفار، من قاله موقناً به حين يصبح فمات من يومه دخل الجنة، ومن قاله موقناً به حين يمسي فمات من ليلته دخل الجنة.",
          source: "رواه البخاري", hadith_number: "6306"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ إِنِّي أَمْسَيْتُ أُشْهِدُكَ وَأُشْهِدُ حَمَلَةَ عَرْشِكَ وَمَلَائِكَتَكَ وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ لَا إِلَهَ إِلَّا أَنْتَ وَحْدَكَ لَا شَرِيكَ لَكَ، وَأَنَّ مُحَمَّدًا عَبْدُكَ وَرَسُولُكَ.",
          repeat: 4,
          meaning: "يستشهد المسلم الله وملائكته وحملة عرشه وجميع خلقه على توحيد الله وربوبيته وإلهيته، وعلى نبوة محمد صلى الله عليه وسلم، تأكيدًا لإيمانه ويقينه.",
          virtue: "فضلها: من قالها أربع مرات حين يصبح أو يمسي أعتقه الله من النار.",
          source: "رواه أبو داود", hadith_number: "5071"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ مَا أَمْسَى بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ فَمِنْكَ وَحْدَكَ لَا شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ.",
          repeat: 1,
          meaning: "يقر المسلم بأن كل نعمة وصلت إليه أو إلى غيره من الخلق هي من الله وحده لا شريك له في ذلك، ويحمده ويشكره عليها.",
          virtue: "فضلها: من قالها حين يصبح فقد أدى شكر يومه، ومن قالها حين يمسي فقد أدى شكر ليلته.",
          source: "رواه أبو داود", hadith_number: "5073"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ عَافِنِي فِي بَدَنِي، اللَّهُمَّ عَافِنِي فِي سَمْعِي، اللَّهُمَّ عَافِنِي فِي بَصَرِي، لَا إِلَهَ إِلَّا أَنْتَ.",
          repeat: 3,
          meaning: "دعاء جامع يطلب فيه المسلم من الله تعالى أن يعافيه في صحته الجسدية، وفي حواس السمع والبصر، مؤكدًا على توحيد الله.",
          virtue: "من الأذكار التي تطلب من الله العافية في الجسد والحواس، وهي من جوامع الدعاء.",
          source: "رواه أبو داود", hadith_number: "5090"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْكُفْرِ وَالْفَقْرِ، اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عَذَابِ الْقَبْرِ، لَا إِلَهَ إِلَّا أَنْتَ.",
          repeat: 3,
          meaning: "يستعيذ المسلم بالله من الكفر الذي هو أشد الضلال، ومن الفقر الذي قد يجر إلى الكفر، ومن عذاب القبر.",
          virtue: "دعاء جامع لطلب الحماية من أعظم الشرور في الدنيا والآخرة.",
          source: "رواه أبو داود", hadith_number: "5090"
        },
        { text: "أذكار المساء\n\nحَسْبِيَ اللَّهُ لَا إِلَهَ إِلَّا هُوَ عَلَيْهِ تَوَكَّلْتُ وَهُوَ رَبُّ الْعَرْشِ الْعَظِيمِ.",
          repeat: 7,
          meaning: "يؤكد المسلم أن الله وحده يكفيه ويحميه، لا معبود بحق سواه، وعليه وحده توكل في جميع أموره، وهو رب العرش العظيم، أي مالك كل شيء.",
          virtue: "فضلها: من قالها سبع مرات حين يصبح أو يمسي كفاه الله ما أهمه من أمر الدنيا والآخرة.",
          source: "رواه أبو داود", hadith_number: "5081"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي الدُّنْيَا وَالْآخِرَةِ، اللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي دِينِي وَدُنْيَايَ وَأَهْلِي وَمَالِي، اللَّهُمَّ اسْتُرْ عَوْرَاتِي، وَآمِنْ رَوْعَاتِي، اللَّهُمَّ احْفَظْنِي مِنْ بَيْنِ يَدَيَّ وَمِنْ خَلْفِي وَعَنْ يَمِينِي وَعَنْ شِمَالِي وَمِنْ فَوْقِي، وَأَعُوذُ بِعَظَمَتِكَ أَنْ أُغْتَالَ مِنْ تَحْتِي.",
          repeat: 1,
          meaning: "دعاء شامل لطلب العفو والعافية في كل جوانب الحياة الدينية والدنيوية، وللأهل والمال، وستر العيوب، وتأمين المخاوف، وطلب الحفظ من كل الجهات، والاستعاذة من الموت غدرًا.",
          virtue: "من أجمع الأدعية لطلب خير الدنيا والآخرة والحماية من كل الشرور.",
          source: "رواه أبو داود", hadith_number: "5074"
        },
        { text: "أذكار المساء\n\nيَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ، أَصْلِحْ لِي شَأْنِي كُلَّهُ، وَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ.",
          repeat: 1,
          meaning: "دعاء يتوجه فيه المسلم إلى الله بأسمائه الحسنى 'الحي' الذي لا يموت، 'القيوم' القائم على تدبير كل شيء، مستغيثًا برحمته ليُصلح له كل أموره، وطلبًا لعدم تركه لنفسه أبدًا.",
          virtue: "من الأدعية العظيمة التي تطلب من الله التوفيق في كل الأمور، وعدم التخلي عن العبد لحظة.",
          source: "رواه الحاكم وصححه الذهبي", hadith_number: "1/545"
        },
        { text: "أذكار المساء\n\nأَمْسَيْنَا عَلَى فِطْرَةِ الْإِسْلَامِ وَكَلِمَةِ الْإِخْلَاصِ وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ وَعَلَى مِلَّةِ أَبِينَا إِبْرَاهِيمَ حَنِيفًا مُسْلِمًا وَمَا كَانَ مِنَ الْمُشْرِكِينَ.",
          repeat: 1,
          meaning: "يجدد المسلم في هذا الذكر عهد إسلامه، وإخلاص توحيده لله، وتمسكه بدين النبي محمد صلى الله عليه وسلم، وملة أبيه إبراهيم عليه السلام التي هي الحنيفية السمحة، براءً من الشرك وأهله.",
          virtue: "تأكيد على الثبات على الإسلام والتوحيد والسنة، واعتزاز بالدين.",
          source: "رواه أحمد", hadith_number: "15360"
        },
        { text: "أذكار المساء\n\nسُبْحَانَ اللَّهِ وَبِحَمْدِهِ عَدَدَ خَلْقِهِ وَرِضَا نَفْسِهِ وَزِنَةَ عَرْشِهِ وَمِدَادَ كَلِمَاتِهِ.",
          repeat: 3,
          meaning: "تسبيح لله تعالى بصفات الكمال والجمال، وتقديسه بحمد لا يحصيه أحد إلا هو، بقدر عدد مخلوقاته، وبقدر ما يرضي ذاته العلية، وبوزن عرشه العظيم، وبقدر كلمات علمه وحكمته التي لا تنتهي.",
          virtue: "كلمات يسيرة لكنها تحمل أجرًا عظيمًا ومضاعفًا لعظم القدر الذي يذكره المسلم بها، وهي تعدل أضعافًا مضاعفة من الذكر العادي.",
          source: "رواه مسلم", hadith_number: "2726"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ صَلِّ وَسَلِّمْ عَلَى نَبِيِّنَا مُحَمَّدٍ.",
          repeat: 10,
          meaning: "طلب من الله تعالى أن يثني على نبيه محمد صلى الله عليه وسلم في الملأ الأعلى، وأن يحفظه من كل سوء، وأن ينزل عليه الرحمة والبركة والسلام.",
          virtue: "فضل الصلاة على النبي صلى الله عليه وسلم عظيم، فمن صلى عليه صلاة واحدة صلى الله عليه بها عشراً.",
          source: "رواه مسلم", hadith_number: "384"
        },
        { text: "أذكار المساء\n\nاللَّهُمَّ إِنَّا نَعُوذُ بِكَ مِنْ أَنْ نُشْرِكَ بِكَ شَيْئًا نَعْلَمُهُ، وَنَسْتَغْفِرُكَ لِمَا لَا نَعْلَمُهُ.",
          repeat: 1,
          meaning: "دعاء يطلب فيه المسلم من الله أن يحميه من الوقوع في الشرك، سواء كان الشرك الأكبر أو الأصغر، سواء كان يعلمه أو يقع فيه بغير قصد أو علم، ويسأل الله المغفرة لما قد يكون وقع فيه من شرك خفي لا يعلمه.",
          virtue: "حماية من الشرك الخفي والشرك الجلي، وتجديد للتوبة والرجوع إلى الله.",
          source: "رواه أحمد", hadith_number: "4/403"
        },
        { text: "أذكار المساء\n\nسُبْحَانَ اللَّهِ وَبِحَمْدِهِ.",
          repeat: 100,
          meaning: "تنـزيه لله عن كل نقص، واعتراف بفضله وكماله، مقروناً بالثناء عليه.",
          virtue: "فضلها: من قالها مائة مرة في اليوم غفرت خطاياه وإن كانت مثل زبد البحر.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6405، مسلم: 2691"
        },
        { text: "أذكار المساء\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ.",
          repeat: 100,
          meaning: "إقرار بالتوحيد الخالص لله، وأنه لا معبود بحق سواه، وهو المتفرد بالملك والتصرف في الكون، وله الثناء والحمد، وهو ذو القدرة المطلقة على كل شيء.",
          virtue: "فضلها: من قالها مائة مرة في يوم كانت له عدل عشر رقاب (تحرير عشر عبيد)، وكتبت له مائة حسنة، ومحيت عنه مائة سيئة، وكانت له حرزاً من الشيطان يومه ذلك حتى يمسي، ولم يأت أحد بأفضل مما جاء به إلا رجل عمل أكثر منه.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6403، مسلم: 2691"
        },
        // أذكار إضافية (أمثلة)
        { text: "أذكار المساء\n\nرَضِيتُ بِاللَّهِ رَبًّا، وَبِالْإِسْلَامِ دِينًا، وَبِمُحَمَّدٍ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ نَبِيًّا.",
          repeat: 3,
          meaning: "أرضى وأطمئن بالله ربًّا لي ومدبرًا لجميع أموري، وبالإسلام دينًا كاملاً وشاملاً لطريقتي في الحياة، وبمحمد صلى الله عليه وسلم نبيًّا ورسولاً أقتدي به.",
          virtue: "فضلها: من قالها حين يصبح وحين يمسي كان حقًا على الله أن يرضيه يوم القيامة.",
          source: "رواه الترمذي", hadith_number: "3389"
        }
    ];

    const sleepAzkar = [
        { text: "أذكار النوم\n\nبِاسْمِكَ رَبِّي وَضَعْتُ جَنْبِي وَبِكَ أَرْفَعُهُ، إِنْ أَمْسَكْتَ نَفْسِي فَارْحَمْهَا، وَإِنْ أَرْسَلْتَهَا فَاحْفَظْهَا بِمَا تَحْفَظُ بِهِ عِبَادَكَ الصَّالِحِينَ.",
          repeat: 1,
          meaning: "أدعو باسمك يا ربي عند نومي واستيقاظي، فإن توفيت نفسي فلتشملها رحمتك، وإن أبقيتها فاحفظها برعايتك التي تحفظ بها عبادك الصالحين.",
          virtue: "فضله: إذا قالها المسلم عند النوم، فإن مات في ليلته مات على الفطرة، وإن قام فإنه يقوم على خير.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6320، مسلم: 2714"
        },
        { text: "أذكار النوم\n\nاللَّهُمَّ قِنِي عَذَابَكَ يَوْمَ تَبْعَثُ عِبَادَكَ.",
          repeat: 3,
          meaning: "اللهم احفظني من عذابك يوم القيامة، يوم تقوم الأرواح وتُبعث الأجساد للحساب.",
          virtue: "فضله: كان النبي صلى الله عليه وسلم يقول هذا الدعاء إذا أراد أن ينام.",
          source: "رواه الترمذي", hadith_number: "3398"
        },
        { text: "أذكار النوم\n\nسُبْحَانَ اللَّهِ (33) وَالْحَمْدُ لِلَّهِ (33) وَاللَّهُ أَكْبَرُ (34).",
          repeat: 1,
          meaning: "تنـزيه لله عن كل نقص، والثناء عليه بجميع المحامد، وتكبير له سبحانه.",
          virtue: "فضله: كان النبي صلى الله عليه وسلم يوصي فاطمة وعليًا رضي الله عنهما بهذه التسبيحات قبل النوم، وقال: 'هو خير لكما من خادم'.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 5362، مسلم: 2727"
        },
        { text: "أذكار النوم\n\nاللَّهُمَّ أَسْلَمْتُ نَفْسِي إِلَيْكَ، وَفَوَّضْتُ أَمْرِي إِلَيْكَ، وَوَجَّهْتُ وَجْهِي إِلَيْكَ، وَأَلْجَأْتُ ظَهْرِي إِلَيْكَ، رَغْبَةً وَرَهْبَةً إِلَيْكَ، لَا مَلْجَأَ وَلَا مَنْجَى مِنْكَ إِلَّا إِلَيْكَ، آمَنْتُ بِكِتَابِكَ الَّذِي أَنْزَلْتَ، وَبِنَبِيِّكَ الَّذِي أَرْسَلْتَ.",
          repeat: 1,
          meaning: "أسلمت نفسي وحياتي وتدبير أموري إليك يا رب، وتوجهت بكليتي إليك، واعتمدت عليك في كل أمري، رغبة في ثوابك وخوفًا من عقابك، فلا مفر ولا خلاص إلا باللجوء إليك، وأنا مؤمن بكتابك المنزل (القرآن) ونبيك المرسل (محمد صلى الله عليه وسلم).",
          virtue: "فضله: من قالهن ومات من ليلته مات على الفطرة.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6311، مسلم: 2710"
        },
        { text: "أذكار النوم\n\nالْحَمْدُ لِلَّهِ الَّذِي أَطْعَمَنَا وَسَقَانَا وَكَفَانَا وَآوَانَا، فَكَمْ مِمَّنْ لَا كَافِيَ لَهُ وَلَا مُؤْوِيَ.",
          repeat: 1,
          meaning: "أحمد الله الذي رزقنا الطعام والشراب، وحفظنا من كل سوء، وجعل لنا مأوى نأوي إليه، فكم من الناس لا يجدون من يكفيهم أو يؤويهم.",
          virtue: "شكر لله على نعمه العظيمة في الرزق والمأوى والحفظ.",
          source: "رواه مسلم", hadith_number: "2715"
        },
        { text: "أذكار النوم\n\nقُلْ يَا أَيُّهَا الْكَافِرُونَ...",
          repeat: 1,
          meaning: "إعلان البراءة من الشرك والمشركين، وتأكيد على التوحيد الخالص لله تعالى.",
          virtue: "فضله: براءة من الشرك.",
          source: "رواه الترمذي", hadith_number: "3400"
        },
        { text: "أذكار النوم\n\nبِاسْمِكَ اللَّهُمَّ أَمُوتُ وَأَحْيَا.",
          repeat: 1,
          meaning: "أنام باسمك اللهم، وأستيقظ باسمك، أي بتقديرك وإرادتك تتم حياتي ومماتي.",
          virtue: "من الأدعية التي وردت عن النبي صلى الله عليه وسلم عند النوم.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6324، مسلم: 2711"
        },
        { text: "أذكار النوم\n\nيَجْمَعُ كَفَّيْهِ ثُمَّ يَنْفُثُ فِيهِمَا فَيَقْرَأُ فِيهِمَا قُلْ هُوَ اللَّهُ أَحَدٌ وَقُلْ أَعُوذُ بِرَبِّ الْفَلَقِ وَقُلْ أَعُوذُ بِرَبِّ النَّاسِ ثُمَّ يَمْسَحُ بِهِمَا مَا اسْتَطَاعَ مِنْ جَسَدِهِ، يَبْدَأُ بِهِمَا عَلَى رَأْسِهِ وَوَجْهِهِ وَمَا أَقْبَلَ مِنْ جَسَدِهِ، يَفْعَلُ ذَلِكَ ثَلَاثَ مَرَّاتٍ.",
          repeat: 1,
          meaning: "يجمع المسلم كفيه، وينفث فيهما (نفث خفيف بلا ريق)، ثم يقرأ سورة الإخلاص والفلق والناس، ثم يمسح بهما وجهه وما استطاع من جسده، ويكرر ذلك ثلاث مرات، كتحصين ودعاء بالبركة والحفظ.",
          virtue: "فضله: كان النبي صلى الله عليه وسلم يفعل ذلك كل ليلة عند نومه، وهذا يدل على أهمية هذه السور في التحصين والحفظ من الشرور.",
          source: "رواه البخاري", hadith_number: "5017"
        },
    ];

    const wakingAzkar = [
        { text: "أذكار الاستيقاظ\n\nالْحَمْدُ لِلَّهِ الَّذِي أَحْيَانَا بَعْدَ مَا أَمَاتَنَا وَإِلَيْهِ النُّشُورُ.",
          repeat: 1,
          meaning: "أحمد الله الذي أعاد إلينا الحياة بعد الموت الصغير (النوم)، وإليه وحده المرجع بعد الموت الأكبر يوم القيامة للحساب.",
          virtue: "شكر لله على نعمة اليقظة وإعادة الروح، وتذكر البعث والنشور.",
          source: "رواه البخاري", hadith_number: "6312"
        },
        { text: "أذكار الاستيقاظ\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ. سُبْحَانَ اللَّهِ، وَالْحَمْدُ لِلَّهِ، وَلَا إِلَهَ إِلَّا اللَّهُ، وَاللَّهُ أَكْبَرُ، وَلَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللَّهِ.",
          repeat: 1,
          meaning: "إقرار بتوحيد الله، وأنه لا معبود بحق سواه، المتفرد بالملك والحمد، ذو القدرة المطلقة. وتسبيح له، وحمد، وإقرار بأنه لا قوة ولا حول إلا به سبحانه.",
          virtue: "فضله: من قالها ثم دعا استجيب له، وإن توضأ وصلى قبلت صلاته.",
          source: "رواه البخاري", hadith_number: "1154"
        },
        { text: "أذكار الاستيقاظ\n\nأَصْبَحْنَا عَلَى فِطْرَةِ الْإِسْلَامِ وَكَلِمَةِ الْإِخْلَاصِ وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ وَعَلَى مِلَّةِ أَبِينَا إِبْرَاهِيمَ حَنِيفًا مُسْلِمًا وَمَا كَانَ مِنَ الْمُشْرِكِينَ.",
          repeat: 1,
          meaning: "نستقبل صباحنا على فطرة الإسلام النقية، وعلى كلمة التوحيد الخالص، وعلى دين نبينا محمد صلى الله عليه وسلم، وعلى ملة أبينا إبراهيم عليه السلام الذي كان حنيفًا مسلمًا، متبرئين من الشرك وأهله.",
          virtue: "تأكيد على الثبات على الإسلام والتوحيد والسنة، واعتزاز بالدين في بداية اليوم.",
          source: "رواه أحمد", hadith_number: "15360"
        },
        { text: "أذكار الاستيقاظ\n\nاللَّهُمَّ إِنِّي أَسْأَلُكَ خَيْرَ هَذَا الْيَوْمِ فَتْحَهُ وَنَصْرَهُ وَنُورَهُ وَبَرَكَتَهُ وَهُدَاهُ، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِيهِ وَشَرِّ مَا بَعْدَهُ.",
          repeat: 1,
          meaning: "اللهم إني أطلب منك خير هذا اليوم، من تيسير أموري فيه وفتح أبواب الخير، والنصر على كل سوء، والنور الذي يهدي إلى الحق، والبركة في كل ما أفعله، والهداية إلى الصراط المستقيم. وأستعيذ بك من كل شر قد يحدث فيه أو يأتي بعده.",
          virtue: "دعاء شامل لطلب الخير في اليوم كله والحماية من شروره.",
          source: "رواه أبو داود", hadith_number: "5084"
        }
    ];

    const afterPrayerAzkar = [
        { text: "أذكار بعد الصلوات\n\nأَسْتَغْفِرُ اللَّهَ.",
          repeat: 3,
          meaning: "أطلب المغفرة من الله تعالى، تعبيرًا عن التوبة والرجوع إليه من كل ذنب أو تقصير.",
          virtue: "من السنن الثابتة بعد الانتهاء من الصلاة، وفيه جبر للتقصير الذي قد يحدث في الصلاة.",
          source: "رواه مسلم", hadith_number: "591"
        },
        { text: "أذكار بعد الصلوات\n\nاللَّهُمَّ أَنْتَ السَّلَامُ وَمِنْكَ السَّلَامُ تَبَارَكْتَ يَا ذَا الْجَلَالِ وَالْإِكْرَامِ.",
          repeat: 1,
          meaning: "اللهم أنت السلام (الذي لا عيب فيه ولا نقص)، ومنك السلامة والأمان، تعظمت وتكرمت يا صاحب العظمة والكرم.",
          virtue: "من الأذكار التي كان النبي صلى الله عليه وسلم يقولها بعد السلام من الصلاة.",
          source: "رواه مسلم", hadith_number: "591"
        },
        { text: "أذكار بعد الصلوات\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ. اللَّهُمَّ لَا مَانِعَ لِمَا أَعْطَيْتَ، وَلَا مُعْطِيَ لِمَا مَنَعْتَ، وَلَا يَنْفَعُ ذَا الْجَدِّ مِنْكَ الْجَدُّ.",
          repeat: 1,
          meaning: "إقرار بالتوحيد لله، وبأنه المالك والمدبر لكل شيء، لا يملك أحد منع ما أعطاه الله، ولا إعطاء ما منعه الله، ولا ينفع صاحب الحظ والغنى حظه وغناه من عذاب الله إذا أراد به سوءًا.",
          virtue: "من الأذكار الجامعة التي تُقال بعد الصلاة، وتؤكد على توحيد الله وكمال قدرته وتصرفه في الملك.",
          source: "رواه البخاري ومسلم", hadith_number: "البخاري: 6615، مسلم: 593"
        },
        { text: "أذكار بعد الصلوات\n\nسُبْحَانَ اللَّهِ (33) وَالْحَمْدُ لِلَّهِ (33) وَاللَّهُ أَكْبَرُ (33).",
          repeat: 1,
          meaning: "تنـزيه لله عن كل نقص، والثناء عليه بجميع المحامد، وتكبير له سبحانه.",
          virtue: "فضلها: من قالها بعد كل صلاة غفرت خطاياه وإن كانت مثل زبد البحر.",
          source: "رواه مسلم", hadith_number: "597"
        },
        { text: "أذكار بعد الصلوات\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ يُحْيِي وَيُمِيتُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ.",
          repeat: 10,
          meaning: "إقرار بالتوحيد الخالص لله، وأنه لا معبود بحق سواه، المتفرد بالملك والحمد، والذي بيده الحياة والموت، وهو ذو القدرة المطلقة على كل شيء.",
          virtue: "تقال بعد صلاة المغرب والفجر، وقد ورد في فضلها أنها تُعدل عتق أربع رقاب، وتُكتب له عشر حسنات، وتُمحى عنه عشر سيئات.",
          source: "رواه الترمذي", hadith_number: "3470"
        },
        { text: "آيَةُ الْكُرْسِيِّ (بعد كل صلاة).",
          repeat: 1,
          meaning: "تبين الآية عظمة الله ووحدانيته وحياته وقيوميته وعلمه وقدرته المطلقة على حفظ السماوات والأرض.",
          virtue: "فضلها: من قرأها دبر كل صلاة مكتوبة لم يمنعه من دخول الجنة إلا أن يموت.",
          source: "رواه النسائي", hadith_number: "100/1"
        },
        // أذكار إضافية (أمثلة)
        { text: "أذكار بعد الصلوات\n\nاللَّهُمَّ أَعِنِّي عَلَى ذِكْرِكَ، وَشُكْرِكَ، وَحُسْنِ عِبَادَتِكَ.",
          repeat: 1,
          meaning: "اللهم اجعلني قادراً على الإكثار من ذكرك، والشكر على نعمك، وأداء العبادات على أكمل وجه وأحسن حال.",
          virtue: "وصية نبوية جامعة من النبي صلى الله عليه وسلم لمعاذ بن جبل رضي الله عنه.",
          source: "رواه أبو داود والنسائي", hadith_number: "أبو داود: 1522"
        }
    ];

    // أذكار إضافية متنوعة (أمثلة)
    const generalAzkar = [
        { text: "أذكار متنوعة\n\nبِسْمِ اللَّهِ.",
          repeat: 1,
          meaning: "أي: أبدأ كل عمل باسم الله، طلبًا للبركة والاستعانة به.",
          virtue: "البركة في كل عمل يبدأ به، وحماية من الشيطان. (أحاديث عامة في التسمية)"
        },
        { text: "أذكار متنوعة\n\nالْحَمْدُ لِلَّهِ.",
          repeat: 1,
          meaning: "الثناء على الله بصفاته الحميدة، وشكره على نعمه الظاهرة والباطنة.",
          virtue: "تملأ الميزان، وهي من أحب الكلمات إلى الله. (رواه مسلم)."
        },
        { text: "أذكار متنوعة\n\nاللَّهُمَّ اغْفِرْ لِي وَارْحَمْنِي وَعَافِنِي وَارْزُقْنِي.",
          repeat: 1,
          meaning: "دعاء جامع يطلب فيه المسلم من الله المغفرة لذنوبه، والرحمة التي تشمل كل خير، والعافية في الدين والدنيا، والرزق الحلال الطيب.",
          virtue: "من جوامع الدعاء التي كان النبي صلى الله عليه وسلم يداوم عليها.",
          source: "رواه مسلم", hadith_number: "2697"
        }
    ];

let currentAzkarType = '';
let currentAzkar = [];
let azkarIndex = 0;
let currentCount = 0;
let customAzkar = [];
let deferredPrompt;
let notificationPermission = 'default';
let stats = {
    completedAzkarToday: 0,
    totalCompletedAzkar: 0,
    lastSessionDate: null
};

// Utility Functions
function saveSettings() {
  localStorage.setItem('darkMode', document.body.classList.contains('dark'));
  localStorage.setItem('fontFamily', document.documentElement.style.getPropertyValue('--font-family'));
  localStorage.setItem('baseFontSize', document.documentElement.style.getPropertyValue('--base-font-size'));
  localStorage.setItem('azkarFontSize', document.documentElement.style.getPropertyValue('--azkar-font-size'));
  localStorage.setItem('fontColor', document.documentElement.style.getPropertyValue('--azkar-text-color'));
  localStorage.setItem('bgColor', document.documentElement.style.getPropertyValue('--primary-bg'));
  localStorage.setItem('currentTheme', document.body.dataset.theme || 'royal-blue');
  localStorage.setItem('customAzkar', JSON.stringify(customAzkar));
  localStorage.setItem('notificationPermission', notificationPermission);
  localStorage.setItem('azkarStats', JSON.stringify(stats));
}

function loadSettings() {
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
    document.getElementById('darkModeText').textContent = 'إيقاف';
  } else {
    document.getElementById('darkModeText').textContent = 'تفعيل';
  }

  const savedFont = localStorage.getItem('fontFamily');
  if (savedFont) {
    document.documentElement.style.setProperty('--font-family', savedFont);
    const fontSelect = document.getElementById('fontSelect');
    if (fontSelect) fontSelect.value = savedFont;
  }

  const savedBaseFontSize = localStorage.getItem('baseFontSize');
  const savedAzkarFontSize = localStorage.getItem('azkarFontSize');
  if (savedBaseFontSize && savedAzkarFontSize) {
      document.documentElement.style.setProperty('--base-font-size', savedBaseFontSize);
      document.documentElement.style.setProperty('--azkar-font-size', savedAzkarFontSize);
      const fontSizeRange = document.getElementById('fontSizeRange');
      if (fontSizeRange) {
          fontSizeRange.value = parseFloat(savedBaseFontSize);
          document.getElementById('fontSizeValue').textContent = `${fontSizeRange.value}em`;
      }
  }

  const savedFontColor = localStorage.getItem('fontColor');
  if (savedFontColor) {
    document.documentElement.style.setProperty('--azkar-text-color', savedFontColor);
    const fontColorPicker = document.getElementById('fontColorPicker');
    if (fontColorPicker) fontColorPicker.value = savedFontColor;
  }
  
  const savedBgColor = localStorage.getItem('bgColor');
  if (savedBgColor) {
    document.documentElement.style.setProperty('--primary-bg', savedBgColor);
    const bgColorPicker = document.getElementById('bgColorPicker');
    if (bgColorPicker) bgColorPicker.value = savedBgColor;
  }
  
  const savedTheme = localStorage.getItem('currentTheme');
  if (savedTheme) {
    applyTheme(savedTheme, false);
  } else {
    applyTheme('royal-blue', false);
  }

  const savedCustomAzkar = localStorage.getItem('customAzkar');
  if (savedCustomAzkar) {
    try {
      customAzkar = JSON.parse(savedCustomAzkar);
    } catch (e) {
      console.error("Error parsing custom azkar from localStorage:", e);
      customAzkar = [];
    }
  }

  const savedStats = localStorage.getItem('azkarStats');
  if (savedStats) {
      try {
          stats = JSON.parse(savedStats);
          const today = new Date().toDateString();
          if (stats.lastSessionDate !== today) {
              stats.completedAzkarToday = 0;
              stats.lastSessionDate = today;
              saveSettings();
          }
      } catch (e) {
          console.error("Error parsing stats from localStorage:", e);
          stats = { completedAzkarToday: 0, totalCompletedAzkar: 0, lastSessionDate: null };
      }
  } else {
      stats.lastSessionDate = new Date().toDateString();
      saveSettings();
  }

  notificationPermission = localStorage.getItem('notificationPermission') || 'default';
  updateNotificationToggleButton();
}

function resetSettings() {
    if (confirm('هل أنت متأكد من إعادة تعيين جميع الإعدادات إلى الافتراضيات؟')) {
        localStorage.clear();
        location.reload();
    }
}

function resetStats() {
    if (confirm('هل أنت متأكد من مسح جميع بيانات الإحصائيات؟ لا يمكن التراجع عن هذا الإجراء.')) {
        stats = { completedAzkarToday: 0, totalCompletedAzkar: 0, lastSessionDate: new Date().toDateString() };
        saveSettings();
        updateStatsDisplay();
        alert('تم مسح الإحصائيات بنجاح.');
    }
}

function toggleDarkMode() {
  document.body.classList.toggle('dark');
  const text = document.getElementById('darkModeText');
  if (document.body.classList.contains('dark')) {
    text.textContent = 'إيقاف';
  } else {
    text.textContent = 'تفعيل';
  }
  saveSettings();
}

function changeFont() {
  const fontSelect = document.getElementById('fontSelect');
  if (fontSelect) {
    document.documentElement.style.setProperty('--font-family', fontSelect.value);
    saveSettings();
  }
}

function changeFontSize(value) {
    const baseSize = parseFloat(value);
    const azkarSize = baseSize + 0.2;
    document.documentElement.style.setProperty('--base-font-size', `${baseSize}em`);
    document.documentElement.style.setProperty('--azkar-font-size', `${azkarSize}em`);
    document.getElementById('fontSizeValue').textContent = `${baseSize}em`;
    saveSettings();
}

function changeColors() {
  const fontColorPicker = document.getElementById('fontColorPicker');
  const bgColorPicker = document.getElementById('bgColorPicker');

  if (fontColorPicker) document.documentElement.style.setProperty('--azkar-text-color', fontColorPicker.value);
  if (bgColorPicker) document.documentElement.style.setProperty('--primary-bg', bgColorPicker.value);

  document.body.classList.remove('theme-green', 'theme-blue', 'theme-brown');
  document.body.dataset.theme = 'custom';
  document.querySelectorAll('.theme-buttons .button').forEach(btn => btn.classList.remove('active-theme'));

  saveSettings();
}

function applyTheme(themeName, save = true) {
    document.body.classList.remove('theme-green', 'theme-blue', 'theme-brown');
    document.body.dataset.theme = themeName;

    if (themeName === 'green') {
        document.body.classList.add('theme-green');
    } else if (themeName === 'blue') {
        document.body.classList.add('theme-blue');
    } else if (themeName === 'brown') {
        document.body.classList.add('theme-brown');
    }

    document.querySelectorAll('.theme-buttons .button').forEach(btn => {
        btn.classList.remove('active-theme');
        if ((themeName === 'royal-blue' && btn.textContent.trim() === 'أزرق ملكي') ||
            (themeName === 'green' && btn.textContent.trim() === 'أخضر') ||
            (themeName === 'blue' && btn.textContent.trim() === 'أزرق') ||
            (themeName === 'brown' && btn.textContent.trim() === 'بني')) {
            btn.classList.add('active-theme');
        }
    });

    const fontColorPicker = document.getElementById('fontColorPicker');
    const bgColorPicker = document.getElementById('bgColorPicker');
    if (fontColorPicker) fontColorPicker.value = getComputedStyle(document.documentElement).getPropertyValue('--azkar-text-color').trim();
    if (bgColorPicker) bgColorPicker.value = getComputedStyle(document.documentElement).getPropertyValue('--primary-bg').trim();

    if (save) {
        saveSettings();
    }
}

function resetApp() {
    currentAzkarType = '';
    currentAzkar = [];
    azkarIndex = 0;
    currentCount = 0;
    renderMainPage();
    openTab('mainTab', document.querySelector('.tab-button:first-child'));
    updateProgressBar();
    closeNav();
    exitFocusMode();
}

// Azkar Core Logic
function displayAzkar(index) {
    const azkarDisplay = document.getElementById('azkarDisplay');
    const azkarCount = document.getElementById('azkarCount');
    const counterButton = document.getElementById('counterButton');
    const infoButton = document.getElementById('azkarInfoButton');
    const focusButton = document.getElementById('focusModeBtn');

    if (!azkarDisplay || !azkarCount || !counterButton || !infoButton || !focusButton) {
        console.error("Missing required elements for azkar display.");
        return;
    }

    if (index < currentAzkar.length) {
        azkarDisplay.classList.add('fade-out-element');
        azkarDisplay.classList.remove('fade-in-element');

        setTimeout(() => {
            const current = currentAzkar[index];
            azkarDisplay.textContent = current.text;
            currentCount = current.repeat;
            azkarCount.textContent = `العدد المطلوب: ${currentCount}`;
            counterButton.textContent = `اضغط للعد (${currentCount})`;
            counterButton.style.display = 'block';

            if (current.meaning || current.virtue) {
                infoButton.style.display = 'flex';
            } else {
                infoButton.style.display = 'none';
            }
            focusButton.style.display = 'flex';

            azkarDisplay.classList.remove('fade-out-element');
            azkarDisplay.classList.add('fade-in-element');
        }, 300);
    } else {
        azkarDisplay.classList.remove('fade-in-element', 'fade-out-element');
        azkarDisplay.textContent = 'تم الانتهاء من جميع الأذكار! جزاكم الله خيرًا.';
        azkarCount.textContent = '';
        counterButton.style.display = 'none';
        infoButton.style.display = 'none';
        focusButton.style.display = 'none';
        document.getElementById('nextAzkarBtn').style.display = 'none';
        document.getElementById('prevAzkarBtn').style.display = 'none';
        document.getElementById('shareAzkarBtn').style.display = 'none';
        document.getElementById('skipAzkarBtn').style.display = 'none';

        if (currentAzkar.length > 0) {
            stats.completedAzkarToday += currentAzkar.length;
            stats.totalCompletedAzkar += currentAzkar.length;
            stats.lastSessionDate = new Date().toDateString();
            saveSettings();
        }
    }
    updateNavigationButtons();
    updateProgressBar();
    updateSideNavActiveItem();
}

function updateCounter() {
    const counterButton = document.getElementById('counterButton');
    if (currentCount > 1) {
        currentCount--;
        document.getElementById('azkarCount').textContent = `العدد المتبقي: ${currentCount}`;
        counterButton.classList.remove('flash');
        void counterButton.offsetWidth;
        counterButton.classList.add('flash');
        counterButton.textContent = `اضغط للعد (${currentCount})`;

        setTimeout(() => {
            counterButton.classList.remove('flash');
        }, 200);
    } else {
        nextAzkar();
    }
}

function nextAzkar() {
    if (azkarIndex < currentAzkar.length - 1) {
        azkarIndex++;
        displayAzkar(azkarIndex);
    } else if (azkarIndex === currentAzkar.length - 1) {
         azkarIndex++;
         displayAzkar(azkarIndex);
    }
}

function prevAzkar() {
    if (azkarIndex > 0) {
        azkarIndex--;
        displayAzkar(azkarIndex);
    }
}

function skipAzkar() {
    azkarIndex++;
    displayAzkar(azkarIndex);
}

function updateNavigationButtons() {
    const nextBtn = document.getElementById('nextAzkarBtn');
    const prevBtn = document.getElementById('prevAzkarBtn');
    const shareBtn = document.getElementById('shareAzkarBtn');
    const skipBtn = document.getElementById('skipAzkarBtn');

    if (azkarIndex < currentAzkar.length) {
        if (nextBtn) nextBtn.style.display = 'inline-block';
        if (shareBtn) shareBtn.style.display = 'inline-block';
        if (skipBtn) skipBtn.style.display = 'inline-block';
    } else {
        if (nextBtn) nextBtn.style.display = 'none';
        if (shareBtn) shareBtn.style.display = 'none';
        if (skipBtn) skipBtn.style.display = 'none';
    }

    if (prevBtn) {
        if (azkarIndex > 0 && azkarIndex < currentAzkar.length) {
            prevBtn.style.display = 'inline-block';
        } else {
            prevBtn.style.display = 'none';
        }
    }
}

function updateProgressBar() {
    const progressBarFill = document.getElementById('progressBarFill');
    const progressText = document.getElementById('progressText');
    const progressContainer = document.getElementById('progressContainer');

    if (!progressBarFill || !progressText || !progressContainer) {
        return;
    }

    if (currentAzkar.length === 0 || currentAzkarType === '') {
        progressBarFill.style.width = '0%';
        progressText.textContent = '0%';
        progressContainer.style.display = 'none';
        return;
    }

    progressContainer.style.display = 'flex';

    const displayedIndex = Math.min(azkarIndex, currentAzkar.length - 1);
    const progressPercentage = (displayedIndex / currentAzkar.length) * 100;

    progressBarFill.style.width = `${progressPercentage}%`;
    progressText.textContent = `${displayedIndex + 1} / ${currentAzkar.length}`;

    if (azkarIndex >= currentAzkar.length) {
        progressBarFill.style.width = '100%';
        progressText.textContent = `تم الإنتهاء!`;
    }
}

function startAzkarSession(type) {
    currentAzkarType = type;
    switch(type) {
        case 'morning':
            currentAzkar = morningAzkar;
            break;
        case 'evening':
            currentAzkar = eveningAzkar;
            break;
        case 'sleep':
            currentAzkar = sleepAzkar;
            break;
        case 'waking':
            currentAzkar = wakingAzkar;
            break;
        case 'afterPrayer':
            currentAzkar = afterPrayerAzkar;
            break;
        case 'custom':
            currentAzkar = customAzkar;
            if (customAzkar.length === 0) {
              alert('لا توجد أذكار مخصصة لبدء الجلسة. الرجاء إضافة أذكار أولاً في تبويب "الأذكار".');
              resetApp();
              return;
            }
            break;
        case 'general':
            currentAzkar = generalAzkar;
            break;
    }
    azkarIndex = 0;
    renderAzkarPage();
    displayAzkar(azkarIndex);
    updateProgressBar();
    populateSideNav();
}

function renderMainPage() {
    const mainTab = document.getElementById('mainTab');
    mainTab.innerHTML = `
        <h2>اختر نوع الأذكار</h2>
        <button class="button" onclick="startAzkarSession('morning')">أذكار الصباح <i class="fas fa-sun"></i></button>
        <button class="button" onclick="startAzkarSession('evening')">أذكار المساء <i class="fas fa-moon"></i></button>
        <button class="button" onclick="startAzkarSession('sleep')">أذكار النوم <i class="fas fa-bed"></i></button>
        <button class="button" onclick="startAzkarSession('waking')">أذكار الاستيقاظ <i class="fas fa-sunrise"></i></button>
        <button class="button" onclick="startAzkarSession('afterPrayer')">أذكار بعد الصلاة <i class="fas fa-pray"></i></button>
        <button class="button" onclick="startAzkarSession('general')">أذكار متنوعة <i class="fas fa-lightbulb"></i></button>
        <button class="button" onclick="startAzkarSession('custom')">قائمة الأذكار المخصصة <i class="fas fa-th-list"></i></button>
        <div class="custom-azkar-area">
            <h3>إدارة الأذكار المخصصة <i class="fas fa-plus-circle"></i></h3>
            <input type="text" id="newAzkarText" placeholder="اكتب الذكر هنا" aria-label="أدخل الذكر الجديد">
            <input type="number" id="newAzkarRepeat" value="1" min="1" aria-label="عدد مرات التكرار">
            <div class="input-group">
                <button class="button" style="background:var(--button-bg-install);" onclick="addCustomAzkar()"><i class="fas fa-plus"></i> إضافة الذكر</button>
            </div>
            <div class="button-group">
                <button class="button" style="background:var(--button-bg-blue);" onclick="importCustomAzkar()"><i class="fas fa-upload"></i> استيراد</button>
                <button class="button" style="background:var(--button-bg-share);" onclick="exportCustomAzkar()"><i class="fas fa-download"></i> تصدير</button>
            </div>
            <input type="text" id="searchCustomAzkar" placeholder="ابحث في الأذكار المخصصة..." onkeyup="renderCustomAzkarList()" style="margin-top: 10px;">
            <ul id="customAzkarList" class="custom-azkar-list"></ul>
        </div>
    `;
    renderCustomAzkarList();
    updateProgressBar();
    closeNav();
}

function renderAzkarPage() {
    const mainTab = document.getElementById('mainTab');
    mainTab.innerHTML = `
        <div id="progressContainer" class="progress-container">
          <div id="progressBarFill" class="progress-bar-fill"></div>
          <span id="progressText" class="progress-text"></span>
        </div>
        <div class="azkar-container">
            <div id="azkarDisplay" class="azkar"></div>
            <button id="azkarInfoButton" class="info-button" onclick="showAzkarInfo()"><i class="fas fa-info-circle"></i></button>
            <button id="focusModeBtn" class="focus-button" onclick="toggleFocusMode()"><i class="fas fa-arrows-alt"></i></button>
        </div>
        <div id="azkarCount" class="count"></div>
        <button id="counterButton" class="counter-btn" onclick="updateCounter()"></button>
        <div class="azkar-navigation">
            <button id="prevAzkarBtn" class="button" style="background:var(--button-bg-prev);" onclick="prevAzkar()"><i class="fas fa-arrow-right"></i> الذكر السابق</button>
            <button id="shareAzkarBtn" class="button" style="background:var(--button-bg-share);" onclick="showShareModal()"><i class="fas fa-share-alt"></i> مشاركة الذكر</button>
            <button id="skipAzkarBtn" class="button" style="background:var(--button-bg-skip);" onclick="skipAzkar()"><i class="fas fa-forward"></i> تخطي</button>
            <button id="nextAzkarBtn" class="button" style="background:var(--button-bg-main);" onclick="nextAzkar()">الذكر التالي <i class="fas fa-arrow-left"></i></button>
        </div>
        <button class="button" style="background:#607d8b; margin-top:20px;" onclick="resetApp()"><i class="fas fa-home"></i> العودة للقائمة الرئيسية</button>
    `;
    updateProgressBar();
    closeNav();
}

// Custom Azkar Management
function addCustomAzkar() {
  const newAzkarText = document.getElementById('newAzkarText');
  const newAzkarRepeat = document.getElementById('newAzkarRepeat');

  if (newAzkarText && newAzkarRepeat) {
    const text = newAzkarText.value.trim();
    const repeat = parseInt(newAzkarRepeat.value);

    if (text && repeat > 0) {
      customAzkar.push({ text: text, repeat: repeat, meaning: "", virtue: "", source: "مخصص", hadith_number: "" });
      newAzkarText.value = '';
      newAzkarRepeat.value = 1;
      renderCustomAzkarList();
      saveSettings();
    } else {
      alert('الرجاء إدخال الذكر وتحديد عدد صحيح للتكرار.');
    }
  }
}

function editCustomAzkar(index) {
    const azkar = customAzkar[index];
    const newText = prompt('تعديل نص الذكر:', azkar.text);
    if (newText !== null && newText.trim() !== '') {
        const newRepeat = parseInt(prompt('تعديل عدد التكرار:', azkar.repeat));
        if (!isNaN(newRepeat) && newRepeat > 0) {
            azkar.text = newText.trim();
            azkar.repeat = newRepeat;
            renderCustomAzkarList();
            saveSettings();
        } else {
            alert('عدد التكرار غير صالح.');
        }
    }
}

function moveCustomAzkar(index, direction) {
    if (direction === 'up' && index > 0) {
        [customAzkar[index], customAzkar[index - 1]] = [customAzkar[index - 1], customAzkar[index]];
    } else if (direction === 'down' && index < customAzkar.length - 1) {
        [customAzkar[index], customAzkar[index + 1]] = [customAzkar[index + 1], customAzkar[index]];
    }
    renderCustomAzkarList();
    saveSettings();
}

function deleteCustomAzkar(index) {
  if (confirm('هل أنت متأكد أنك تريد حذف هذا الذكر؟')) {
    customAzkar.splice(index, 1);
    renderCustomAzkarList();
    saveSettings();
  }
}

function renderCustomAzkarList() {
  const customAzkarList = document.getElementById('customAzkarList');
  const searchInput = document.getElementById('searchCustomAzkar');
  if (!customAzkarList || !searchInput) return;

  const searchTerm = searchInput.value.trim().toLowerCase();
  const filteredAzkar = customAzkar.filter(azkar =>
    azkar.text.toLowerCase().includes(searchTerm)
  );

  customAzkarList.innerHTML = '';
  if (filteredAzkar.length === 0) {
    customAzkarList.innerHTML = '<li style="text-align: center; color: var(--footer-color);">لا توجد أذكار مخصصة مطابقة.</li>';
    return;
  }

  filteredAzkar.forEach((azkar, index) => {
    const originalIndex = customAzkar.indexOf(azkar);
    const listItem = document.createElement('li');
    listItem.innerHTML = `
      <span>${azkar.text} (${azkar.repeat})</span>
      <div class="custom-azkar-actions">
        <button class="move-btn" onclick="moveCustomAzkar(${originalIndex}, 'up')" title="تحريك لأعلى"><i class="fas fa-arrow-up"></i></button>
        <button class="move-btn" onclick="moveCustomAzkar(${originalIndex}, 'down')" title="تحريك لأسفل"><i class="fas fa-arrow-down"></i></button>
        <button class="edit-btn" onclick="editCustomAzkar(${originalIndex})" title="تعديل"><i class="fas fa-edit"></i></button>
        <button onclick="deleteCustomAzkar(${originalIndex})" title="حذف"><i class="fas fa-trash-alt"></i></button>
      </div>
    `;
    customAzkarList.appendChild(listItem);
  });
}

function importCustomAzkar() {
    const importText = prompt('الصق بيانات الأذكار المخصصة هنا (بصيغة JSON):');
    if (importText) {
        try {
            const importedData = JSON.parse(importText);
            if (Array.isArray(importedData) && importedData.every(item => typeof item.text === 'string' && typeof item.repeat === 'number')) {
                customAzkar = importedData;
                renderCustomAzkarList();
                saveSettings();
                alert('تم استيراد الأذكار بنجاح!');
            } else {
                throw new Error('صيغة بيانات غير صحيحة.');
            }
        } catch (e) {
            alert('خطأ في استيراد البيانات. تأكد من أن التنسيق صحيح (JSON).' + e.message);
            console.error(e);
        }
    }
}

function exportCustomAzkar() {
    if (customAzkar.length === 0) {
        alert('لا توجد أذكار مخصصة لتصديرها.');
        return;
    }
    const exportData = JSON.stringify(customAzkar, null, 2);
    openModal('تصدير الأذكار المخصصة <i class="fas fa-download"></i>',
              `<p>انسخ النص التالي وقم بحفظه:</p><textarea id="exportText" readonly>${exportData}</textarea>`,
              `<button class="button" style="background:var(--button-bg-blue);" onclick="copyExportText()"><i class="fas fa-copy"></i> نسخ</button>`);
}

function copyExportText() {
    const exportTextarea = document.getElementById('exportText');
    if (exportTextarea) {
        exportTextarea.select();
        document.execCommand('copy');
        alert('تم نسخ البيانات بنجاح!');
        closeModal();
    }
}

// Modals
function openModal(title, bodyHtml, buttonsHtml = '') {
    const modalOverlay = document.getElementById('infoShareModal');
    const modalHeaderText = document.getElementById('modalHeaderText');
    const modalBodyText = document.getElementById('modalBodyText');
    const modalButtons = document.getElementById('modalButtons');

    modalHeaderText.innerHTML = title;
    modalBodyText.innerHTML = bodyHtml;
    modalButtons.innerHTML = buttonsHtml;

    modalOverlay.classList.add('show');
}

function closeModal() {
    const modalOverlay = document.getElementById('infoShareModal');
    modalOverlay.classList.remove('show');
}

function showShareModal() {
    if (azkarIndex >= 0 && azkarIndex < currentAzkar.length) {
        const current = currentAzkar[azkarIndex];
        let shareContent = `${current.text}\n`;
        if (current.repeat > 1) {
            shareContent += `(العدد: ${current.repeat})\n`;
        }
        if (current.meaning) {
            shareContent += `\nالمعنى:\n${current.meaning}\n`;
        }
        if (current.virtue) {
            shareContent += `\nالفضل:\n${current.virtue}\n`;
        }
        if (current.source) {
            shareContent += `\nالمصدر: ${current.source}`;
            if (current.hadith_number) {
                shareContent += ` (حديث رقم: ${current.hadith_number})`;
            }
            shareContent += `\n`;
        }

        const buttons = `<button class="button" style="background:var(--button-bg-blue);" onclick="copyShareText()"><i class="fas fa-copy"></i> نسخ</button>`;
        openModal('مشاركة الذكر <i class="fas fa-share-alt"></i>', `<textarea id="shareText" readonly>${shareContent}</textarea>`, buttons);
    } else {
        alert('لا يوجد ذكر حالي للمشاركة.');
    }
}

function copyShareText() {
    const shareTextarea = document.getElementById('shareText');
    if (shareTextarea) {
        shareTextarea.select();
        document.execCommand('copy');
        alert('تم نسخ الذكر بنجاح!');
        closeModal();
    }
}

function showAzkarInfo() {
    if (azkarIndex >= 0 && azkarIndex < currentAzkar.length) {
        const azkar = currentAzkar[azkarIndex];
        let infoContent = '';
        if (azkar.meaning) {
            infoContent += `<p><strong>المعنى:</strong><br>${azkar.meaning}</p>`;
        }
        if (azkar.virtue) {
            infoContent += `<p><strong>الفضل:</strong><br>${azkar.virtue}</p>`;
        }
        if (azkar.source) {
            infoContent += `<p><strong>المصدر:</strong> ${azkar.source}`;
            if (azkar.hadith_number) {
                infoContent += ` (حديث رقم: ${azkar.hadith_number})`;
            }
            infoContent += `</p>`;
        }

        if (infoContent) {
            openModal('معنى وفضل الذكر <i class="fas fa-book"></i>', infoContent);
        } else {
            alert('لا توجد معلومات إضافية لهذا الذكر.');
        }
    }
}

// Tab Functionality
function openTab(tabId, element) {
  const tabContents = document.querySelectorAll('.tab-content');
  tabContents.forEach(tabContent => {
    if (tabContent.classList.contains('active')) {
        tabContent.classList.remove('active');
        tabContent.style.display = 'none';
    }
  });

  const tabButtons = document.querySelectorAll('.tab-button');
  tabButtons.forEach(tabButton => {
    tabButton.classList.remove('active');
  });

  const targetTab = document.getElementById(tabId);
  targetTab.style.display = 'block';
  setTimeout(() => {
    targetTab.classList.add('active');
  }, 10);

  element.classList.add('active');

  if (tabId === 'mainTab') {
      if (currentAzkarType === '') {
          renderMainPage();
      } else {
          renderAzkarPage();
          displayAzkar(azkarIndex);
      }
  } else if (tabId === 'settingsTab') {
      loadSettings();
      const fontSizeRange = document.getElementById('fontSizeRange');
      if (fontSizeRange) {
          document.getElementById('fontSizeValue').textContent = `${fontSizeRange.value}em`;
      }
  } else if (tabId === 'statsTab') {
      updateStatsDisplay();
  }
  updateProgressBar();
  closeNav();
  exitFocusMode();
}

// Side Navigation
function populateSideNav() {
    const sidenavAzkarList = document.getElementById('sidenavAzkarList');
    if (!sidenavAzkarList) return;

    sidenavAzkarList.innerHTML = '';
    currentAzkar.forEach((azkar, index) => {
        const azkarName = azkar.text.split('\n')[0].substring(0, 30) + (azkar.text.split('\n')[0].length > 30 ? '...' : '');
        const link = document.createElement('a');
        link.href = 'javascript:void(0)';
        link.textContent = `${index + 1}. ${azkarName}`;
        link.onclick = () => {
            azkarIndex = index;
            displayAzkar(azkarIndex);
            closeNav();
        };
        if (index === azkarIndex) {
            link.classList.add('active-azkar-link');
        }
        sidenavAzkarList.appendChild(link);
    });
}

function updateSideNavActiveItem() {
    const links = document.querySelectorAll('#sidenavAzkarList a');
    links.forEach((link, index) => {
        if (index === azkarIndex) {
            link.classList.add('active-azkar-link');
        } else {
            link.classList.remove('active-azkar-link');
        }
    });
}

function openNav() {
    document.getElementById("mySidenav").classList.add('open');
    document.querySelector(".container").classList.add('sidenav-open');
    document.querySelector(".sidenav-toggle-btn").style.right = '260px';
}

function closeNav() {
    document.getElementById("mySidenav").classList.remove('open');
    document.querySelector(".container").classList.remove('sidenav-open');
    document.querySelector(".sidenav-toggle-btn").style.right = '15px';
}

function toggleNav() {
    const sidenav = document.getElementById("mySidenav");
    if (sidenav.classList.contains('open')) {
        closeNav();
    } else {
        openNav();
    }
}

// Focus Mode
function toggleFocusMode() {
    document.body.classList.toggle('focus-mode');
}

function exitFocusMode() {
    document.body.classList.remove('focus-mode');
}

// PWA Installation
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  const installAppBtn = document.getElementById('installAppBtn');
  if (installAppBtn) {
    installAppBtn.style.display = 'inline-block';
    installAppBtn.addEventListener('click', () => {
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the A2HS prompt');
        } else {
          console.log('User dismissed the A2HS prompt');
        }
        deferredPrompt = null;
        installAppBtn.style.display = 'none';
      });
    });
  }
});

// Notification Permission
function checkNotificationPermission() {
  if (!('Notification' in window)) {
    console.log('This browser does not support notifications.');
    notificationPermission = 'denied';
    updateNotificationToggleButton();
    return;
  }

  notificationPermission = Notification.permission;
  updateNotificationToggleButton();
}

function updateNotificationToggleButton() {
  const notificationToggle = document.getElementById('notificationToggle');
  const notificationText = document.getElementById('notificationText');
  if (!notificationToggle || !notificationText) return;

  if (notificationPermission === 'granted') {
    notificationText.textContent = 'مفعل';
    notificationToggle.style.background = 'var(--button-bg-skip)';
  } else if (notificationPermission === 'denied') {
    notificationText.textContent = 'محظور';
    notificationToggle.style.background = '#9e9e9e';
    notificationToggle.disabled = true;
  } else {
    notificationText.textContent = 'غير مفعل';
    notificationToggle.style.background = 'var(--button-bg-install)';
    notificationToggle.disabled = false;
  }
}

function toggleAzkarNotification() {
  if (!('Notification' in window)) {
    alert('متصفحك لا يدعم الإشعارات.');
    return;
  }

  if (notificationPermission === 'granted') {
    alert('الإشعارات مفعلة بالفعل. لإيقافها، يرجى تغيير الإعدادات في متصفحك.');
    notificationPermission = 'default';
  } else if (notificationPermission === 'default') {
    Notification.requestPermission().then(permission => {
      notificationPermission = permission;
      if (permission === 'granted') {
        alert('تم تفعيل إذن الإشعارات بنجاح. (ملاحظة: هذا مجرد تفعيل للإذن، وليست إشعارات مجدولة)');
      } else {
        alert('تم رفض تفعيل إذن الإشعارات.');
      }
      updateNotificationToggleButton();
      saveSettings();
    });
  } else if (notificationPermission === 'denied') {
    alert('الإشعارات محظورة لمتصفحك. الرجاء تغيير الإعدادات في متصفحك للسماح بالإشعارات لهذا الموقع.');
  }
  updateNotificationToggleButton();
  saveSettings();
}

// Stats Management
function updateStatsDisplay() {
    const completedAzkarTodayEl = document.getElementById('completedAzkarToday');
    const totalCompletedAzkarEl = document.getElementById('totalCompletedAzkar');
    const lastSessionDateEl = document.getElementById('lastSessionDate');

    if (completedAzkarTodayEl) completedAzkarTodayEl.textContent = stats.completedAzkarToday;
    if (totalCompletedAzkarEl) totalCompletedAzkarEl.textContent = stats.totalCompletedAzkar;
    if (lastSessionDateEl) lastSessionDateEl.textContent = stats.lastSessionDate || 'لا توجد';
}

// Initial setup
document.addEventListener('DOMContentLoaded', () => {
  loadSettings();
  renderMainPage();
  checkNotificationPermission();
  updateStatsDisplay();

  // 📦 Enhanced install prompt handling
  let deferredPrompt = null;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;

    const installBtn = document.getElementById('installAppBtn');
    if (installBtn) {
      installBtn.style.display = 'inline-block';
      installBtn.disabled = false;

      if (!installBtn.classList.contains('install-ready')) {
        installBtn.classList.add('install-ready');
        installBtn.addEventListener('click', async () => {
          if (!deferredPrompt) return;

          installBtn.disabled = true;
          await deferredPrompt.prompt();

          const { outcome } = await deferredPrompt.userChoice;
          if (outcome === 'accepted') {
            console.log('✅ User accepted the installation');
            installBtn.style.display = 'none';

            // 📊 Track install response (Google Analytics example)
            if (typeof gtag === 'function') {
              gtag('event', 'app_installed', {
                event_category: 'PWA',
                event_label: 'Fazazi Azkar',
              });
            }
          } else {
            console.log('🚫 User dismissed the installation');
            installBtn.disabled = false;
          }

          deferredPrompt = null;
        });
      }
    }
  });

  window.addEventListener('appinstalled', () => {
    console.log('📱 Fazazi Azkar installed successfully!');
    const installBtn = document.getElementById('installAppBtn');
    if (installBtn) {
      installBtn.style.display = 'none';
    }

    // 📊 Optional additional analytics tracking
    if (typeof gtag === 'function') {
      gtag('event', 'install_success', {
        event_category: 'PWA',
        event_label: 'Fazazi Azkar',
      });
    }

    // 🚀 Optional toast or feedback
    // showToast("🎉 تم تثبيت التطبيق بنجاح!");
  });
});

